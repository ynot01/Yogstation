<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <base href="../" />
    <link rel="stylesheet" href="dmdoc.css" />
    <title>&#x2F;datum&#x2F;dungeon_room - Yogstation 13</title>
</head>
<body>
<header>
    <a href="index.html">Yogstation 13</a> -
    <a href="index.html#modules">Modules</a> -
    <a href="index.html#types">Types</a>
 &mdash; <a href="datum/dungeon_room.html#var">Var Details</a> - <a href="datum/dungeon_room.html#proc">Proc Details</a></header>
<main>
<h1>/<a href="datum.html">datum</a>/<a href="datum/dungeon_room.html">dungeon_room</a>
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L9">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 9"/></a></h1>

<p>This datum represents a &quot;room&quot; which is created by the Dungeon Generator process. Whether you use Binary Space Partition(BSP) or Random Room Placement(RRP),
the Rust algorith will populate the given area with rooms, which are just squares and rectangles of various dimensions with X and Y coordinates. I created
this datum to give better control over the data the generator is using. So you can look through the list of rooms for feedback or to understand what's happening.</p>
<p>The datum has procs to construct itself at the given coordinates, and procs to furnish itself according to the randomly assigned &quot;theme&quot; it chooses for itself
on init.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr>
            <tr><th><a href="datum/dungeon_room.html#var/center">center</a></th><td>The center tile of a room, or at least as close to center as it can get if the room is of different dimensions, or equal dimensions with no center</td></tr>
            <tr><th><a href="datum/dungeon_room.html#var/completed_room">completed_room</a></th><td>If this room needed to get trimmed because it overlapped an area that shouldn't be touched</td></tr>
            <tr><th><a href="datum/dungeon_room.html#var/doors">doors</a></th><td>A list of the doors belonging to a room</td></tr>
            <tr><th><a href="datum/dungeon_room.html#var/exterior">exterior</a></th><td>A list of the outermost turfs. This is used to generate walls and doors</td></tr>
            <tr><th><a href="datum/dungeon_room.html#var/height">height</a></th><td>Tile height of the room, including walls. A 5 height room is a 3 tile tall interior with a wall on each side</td></tr>
            <tr><th><a href="datum/dungeon_room.html#var/id">id</a></th><td>Some kind of identifier. Will default to the number of the rooms in the list, like &quot;Random room 5&quot;</td></tr>
            <tr><th><a href="datum/dungeon_room.html#var/interior">interior</a></th><td>A list of the turfs inside the outer walls. This is the room for activities and decorations </td></tr>
            <tr><th><a href="datum/dungeon_room.html#var/protected_atoms">protected_atoms</a></th><td>List of protected atom types. Rooms use turf.empty() to replace turfs and delete their contents at the same time. This is so that if a room overlaps another,
lingering elements like walls, doors, windows, and even mobs will be removed. This is also helpful if you want to generate over elements that are already
placed by map editors, like in the case of pipes and cables for atmos and station power.</td></tr>
            <tr><th><a href="datum/dungeon_room.html#var/room_type">room_type</a></th><td>for differentiating room types yourself. like maybe 1 is a ruin, and 2 is empty</td></tr>
            <tr><th><a href="datum/dungeon_room.html#var/width">width</a></th><td>Tile width of the room, including walls. A 5 width room is a 3 tile wide interior with a wall on each side</td></tr>
            <tr><th><a href="datum/dungeon_room.html#var/x1">x1</a></th><td>X coordinate of the bottom left corner</td></tr>
            <tr><th><a href="datum/dungeon_room.html#var/x2">x2</a></th><td>X coordinate of the top right corner</td></tr>
            <tr><th><a href="datum/dungeon_room.html#var/y1">y1</a></th><td>Y coordinate of the bottom left corner</td></tr>
            <tr><th><a href="datum/dungeon_room.html#var/y2">y2</a></th><td>Y coordinate of the top right corner</td></tr>
            <tr><th><a href="datum/dungeon_room.html#var/z">z</a></th><td>z-level of the room</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr>
            <tr><th><a href="datum/dungeon_room.html#proc/Initialize">Initialize</a></th><td>Override this for each new room type so you know whether to trim or discard rooms that overlap areas that should remain untouched</td></tr>
            <tr><th><a href="datum/dungeon_room.html#proc/add_doors">add_doors</a></th><td>Add a random number of doors to the room. If you're lucky, people will actually be able to access the room. If not, it's a <del>super secret room</del></td></tr>
            <tr><th><a href="datum/dungeon_room.html#proc/add_features">add_features</a></th><td>Sprinkle in the flavor from the room's theme like blood splatters, trash, or items. The number of flavor items is based on the room size and feature weight</td></tr>
            <tr><th><a href="datum/dungeon_room.html#proc/add_mobs">add_mobs</a></th><td>Add mobs if the room's theme has any, be it rats or space dragons lmao. The number of mobs is based on the room size and mob weight</td></tr>
            <tr><th><a href="datum/dungeon_room.html#proc/add_special_features">add_special_features</a></th><td>Sprinkle in the flavor from the room's theme like blood splatters, trash, or items. The number of flavor items is based on the room size and feature weight</td></tr>
            <tr><th><a href="datum/dungeon_room.html#proc/build_flooring">build_flooring</a></th><td>Build the flooring for the room. Potentially not necessary based on the build area, but making sure the room doesn't construct over space or gen turf is a good idea</td></tr>
            <tr><th><a href="datum/dungeon_room.html#proc/build_walls">build_walls</a></th><td>This loop is for setting the inside of a room to match the area of its center. The reason we also fuck around with the lighting overlays is because
at the time of generation, the lighting subsystem isn't initialized yet, so we'll handle calling the building and clearing of area lighting diffs ourselves.
For each tile in the exterior, build a wall to keep the assistants out. Or a window if the room theme calls for it</td></tr>
            <tr><th><a href="datum/dungeon_room.html#proc/delete_self">delete_self</a></th><td>We toggle the mob AI off as they're created because if the generator is being ran slowly and taking a while to generate, 
mobs can break out of their rooms and start fighting before the generator is even done</td></tr>
            <tr><th><a href="datum/dungeon_room.html#proc/generate">generate</a></th><td>Construct yourself in the game world NOW. Assuming you have a theme to pull from, otherwise stay theoretical.</td></tr>
            <tr><th><a href="datum/dungeon_room.html#proc/is_ruin_compatible">is_ruin_compatible</a></th><td>If you're making an area that has ruin map files, you can use this to determine if it should be a ruin room</td></tr>
            <tr><th><a href="datum/dungeon_room.html#proc/validation_check">validation_check</a></th><td>checks if the room overlaps areas it shouldn't and if it does remove that tile from the room</td></tr></table>
    <h2 id="var">Var Details</h2><h3 id="var/center"><aside class="declaration">var </aside>center
            <aside>&ndash; /<a href="turf.html">turf</a></aside>
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L32">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 32"/></a></h3>
        <p>The center tile of a room, or at least as close to center as it can get if the room is of different dimensions, or equal dimensions with no center</p><h3 id="var/completed_room"><aside class="declaration">var </aside>completed_room
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L73">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 73"/></a></h3>
        <p>If this room needed to get trimmed because it overlapped an area that shouldn't be touched</p><h3 id="var/doors"><aside class="declaration">var </aside>doors
            <aside>&ndash; /list/datum/weakref</aside>
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L58">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 58"/></a></h3>
        <p>A list of the doors belonging to a room</p><h3 id="var/exterior"><aside class="declaration">var </aside>exterior
            <aside>&ndash; /list</aside>
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L43">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 43"/></a></h3>
        <p>A list of the outermost turfs. This is used to generate walls and doors</p>
<ul>
<li>exterior = Full room  -  interior</li>
<li>[X][X][X][X] = [X][X][X][X] - [0][0][0][0]	</li>
<li>[X][0][0][X] = [X][X][X][X] - [0][X][X][0]</li>
<li>[X][0][0][X] = [X][X][X][X] - [0][X][X][0]</li>
<li>[X][X][X][X] = [X][X][X][X] - [0][0][0][0]</li>
</ul><h3 id="var/height"><aside class="declaration">var </aside>height
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L29">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 29"/></a></h3>
        <p>Tile height of the room, including walls. A 5 height room is a 3 tile tall interior with a wall on each side</p><h3 id="var/id"><aside class="declaration">var </aside>id
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L11">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 11"/></a></h3>
        <p>Some kind of identifier. Will default to the number of the rooms in the list, like &quot;Random room 5&quot;</p><h3 id="var/interior"><aside class="declaration">var </aside>interior
            <aside>&ndash; /list</aside>
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L53">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 53"/></a></h3>
        <p>A list of the turfs inside the outer walls. This is the room for activities and decorations </p>
<ul>
<li>Interior area of full room</li>
<li>[0][0][0][0]</li>
<li>[0][X][X][0]</li>
<li>[0][X][X][0]</li>
<li>[0][0][0][0]</li>
</ul><h3 id="var/protected_atoms"><aside class="declaration">var </aside>protected_atoms
            <aside>&ndash; /static/list</aside>
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L67">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 67"/></a></h3>
        <p>List of protected atom types. Rooms use turf.empty() to replace turfs and delete their contents at the same time. This is so that if a room overlaps another,
lingering elements like walls, doors, windows, and even mobs will be removed. This is also helpful if you want to generate over elements that are already
placed by map editors, like in the case of pipes and cables for atmos and station power.</p><h3 id="var/room_type"><aside class="declaration">var </aside>room_type
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L83">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 83"/></a></h3>
        <p>for differentiating room types yourself. like maybe 1 is a ruin, and 2 is empty</p><h3 id="var/width"><aside class="declaration">var </aside>width
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L27">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 27"/></a></h3>
        <p>Tile width of the room, including walls. A 5 width room is a 3 tile wide interior with a wall on each side</p><h3 id="var/x1"><aside class="declaration">var </aside>x1
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L14">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 14"/></a></h3>
        <p>X coordinate of the bottom left corner</p><h3 id="var/x2"><aside class="declaration">var </aside>x2
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L19">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 19"/></a></h3>
        <p>X coordinate of the top right corner</p><h3 id="var/y1"><aside class="declaration">var </aside>y1
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L16">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 16"/></a></h3>
        <p>Y coordinate of the bottom left corner</p><h3 id="var/y2"><aside class="declaration">var </aside>y2
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L21">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 21"/></a></h3>
        <p>Y coordinate of the top right corner</p><h3 id="var/z"><aside class="declaration">var </aside>z
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L24">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 24"/></a></h3>
        <p>z-level of the room</p><h2 id="proc">Proc Details</h2><h3 id="proc/Initialize"><aside class="declaration">proc </aside>Initialize<aside>() 
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L129">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 129"/></a></aside>
        </h3>
        <p>Override this for each new room type so you know whether to trim or discard rooms that overlap areas that should remain untouched</p><h3 id="proc/add_doors"><aside class="declaration">proc </aside>add_doors<aside>() 
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L229">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 229"/></a></aside>
        </h3>
        <p>Add a random number of doors to the room. If you're lucky, people will actually be able to access the room. If not, it's a <del>super secret room</del></p><h3 id="proc/add_features"><aside class="declaration">proc </aside>add_features<aside>() 
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L276">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 276"/></a></aside>
        </h3>
        <p>Sprinkle in the flavor from the room's theme like blood splatters, trash, or items. The number of flavor items is based on the room size and feature weight</p><h3 id="proc/add_mobs"><aside class="declaration">proc </aside>add_mobs<aside>() 
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L307">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 307"/></a></aside>
        </h3>
        <p>Add mobs if the room's theme has any, be it rats or space dragons lmao. The number of mobs is based on the room size and mob weight</p><h3 id="proc/add_special_features"><aside class="declaration">proc </aside>add_special_features<aside>() 
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L264">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 264"/></a></aside>
        </h3>
        <p>Sprinkle in the flavor from the room's theme like blood splatters, trash, or items. The number of flavor items is based on the room size and feature weight</p><h3 id="proc/build_flooring"><aside class="declaration">proc </aside>build_flooring<aside>() 
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L218">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 218"/></a></aside>
        </h3>
        <p>Build the flooring for the room. Potentially not necessary based on the build area, but making sure the room doesn't construct over space or gen turf is a good idea</p><h3 id="proc/build_walls"><aside class="declaration">proc </aside>build_walls<aside>() 
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L201">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 201"/></a></aside>
        </h3>
        <p>This loop is for setting the inside of a room to match the area of its center. The reason we also fuck around with the lighting overlays is because
at the time of generation, the lighting subsystem isn't initialized yet, so we'll handle calling the building and clearing of area lighting diffs ourselves.
For each tile in the exterior, build a wall to keep the assistants out. Or a window if the room theme calls for it</p><h3 id="proc/delete_self"><aside class="declaration">proc </aside>delete_self<aside>() 
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L340">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 340"/></a></aside>
        </h3>
        <p>We toggle the mob AI off as they're created because if the generator is being ran slowly and taking a while to generate, 
mobs can break out of their rooms and start fighting before the generator is even done</p>
<p>Experimental and buggy, but calling this SHOULD remove the room from the game world, along with all the room's tiles and items. 
leaving the area looking how it did before generation. just thanos snap the room off the map like it never existed. however with rooms overlapping
and intersecting this may just remove a chunk of another room</p><h3 id="proc/generate"><aside class="declaration">proc </aside>generate<aside>() 
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L163">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 163"/></a></aside>
        </h3>
        <p>Construct yourself in the game world NOW. Assuming you have a theme to pull from, otherwise stay theoretical.</p><h3 id="proc/is_ruin_compatible"><aside class="declaration">proc </aside>is_ruin_compatible<aside>() 
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L159">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 159"/></a></aside>
        </h3>
        <p>If you're making an area that has ruin map files, you can use this to determine if it should be a ruin room</p><h3 id="proc/validation_check"><aside class="declaration">proc </aside>validation_check<aside>() 
        
    
            <a href="https://github.com/ynot01/Yogstation/blob/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4/code/datums/mapgen/dungeon_generators/dungeon_room.dm#L145">
        <img src="git.png" width="16" height="16" title="code&#x2F;datums&#x2F;mapgen&#x2F;dungeon_generators&#x2F;dungeon_room.dm 145"/></a></aside>
        </h3>
        <p>checks if the room overlaps areas it shouldn't and if it does remove that tile from the room</p></main>
<footer>
    yogstation.dme
    <a href="https://github.com/ynot01/Yogstation/tree/3deeecccf8b03ad18f1c3c8daafe31735c8b13a4">3deeecc</a>
        (master) &mdash; <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.8.0</a></footer>
</body>
</html>
